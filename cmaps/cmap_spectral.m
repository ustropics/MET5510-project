%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FILE DESCRIPTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FILENAME: cmap_spectral.m
%
% DESCRIPTION: Perceptually uniform spectral colormap (red → yellow → blue).
%              Great for continuous data with wide range.
%              Interpolates between 10 sampled colors.
%
% INPUT:
%   n - Number of colors (default: 256)
%
% OUTPUT:
%   cmap - n x 3 RGB matrix (0–1 range)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FUNCTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function cmap = cmap_spectral(n)
    
    %% --------------------------------------------------------------------
    %% 1. Set default input
    %% --------------------------------------------------------------------
    if nargin < 1, n = 256; end

    %% --------------------------------------------------------------------
    %% 2. Define node colors (RGB, 0–1) from Matplotlib Spectral
    %% --------------------------------------------------------------------
    % Hex: #9e0142, #d8434e, #f67a49, #fdbf6f, #feeda1,
    %      #f1f9a9, #bfe5a0, #74c7a5, #378ebb, #5e4fa2
    nodes = [
        0.61961  0.00392  0.25882;
        0.84721  0.26121  0.30519;
        0.96378  0.47743  0.28581;
        0.99346  0.74771  0.43529;
        0.99777  0.93087  0.63306;
        0.94425  0.97770  0.66205;
        0.74771  0.89804  0.62745;
        0.45306  0.78155  0.64629;
        0.21607  0.55563  0.73195;
        0.36863  0.30980  0.63529
    ];

    %% --------------------------------------------------------------------
    %% 3. Interpolate to n colors
    %% --------------------------------------------------------------------
    pos = linspace(0, 1, size(nodes,1));
    cmap = interp1(pos, nodes, linspace(0, 1, n), 'pchip');
end