%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FILE DESCRIPTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FILENAME: cmap_twilight.m
%
% DESCRIPTION: Cyclic twilight colormap (purple → orange → purple).
%              Ideal for phase, wind direction, or periodic data.
%              Interpolates between 10 sampled colors.
%
% INPUT:
%   n - Number of colors (default: 256)
%
% OUTPUT:
%   cmap - n x 3 RGB matrix (0–1 range)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FUNCTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function cmap = cmap_twilight(n)
    
    %% --------------------------------------------------------------------
    %% 1. Set default input
    %% --------------------------------------------------------------------
    if nargin < 1, n = 256; end

    %% --------------------------------------------------------------------
    %% 2. Define node colors (RGB, 0–1) from Matplotlib twilight_shifted
    %% --------------------------------------------------------------------
    % Hex: #301437, #572385, #6066b6, #7ca2c2, #c8d0d6,
    %      #dacac3, #c6896c, #a84750, #6b1b4d, #2f1436
    nodes = [
        0.18739  0.07710  0.21619;
        0.33954  0.13705  0.52329;
        0.37472  0.39956  0.71257;
        0.48674  0.63417  0.76256;
        0.78399  0.81755  0.83937;
        0.85429  0.79097  0.76584;
        0.77591  0.53554  0.42413;
        0.65833  0.27803  0.31346;
        0.41796  0.10421  0.30279;
        0.18488  0.07943  0.21308
    ];

    %% --------------------------------------------------------------------
    %% 3. Interpolate to n colors
    %% --------------------------------------------------------------------
    pos = linspace(0, 1, size(nodes,1));
    cmap = interp1(pos, nodes, linspace(0, 1, n), 'pchip');
end