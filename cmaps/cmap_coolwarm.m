%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FILE DESCRIPTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FILENAME: cmap_coolwarm.m
%
% DESCRIPTION: Diverging blue-white-red colormap (cool to warm).
%              Standard for anomalies, correlations, residuals.
%              Interpolates between 10 sampled colors.
%
% INPUT:
%   n - Number of colors (default: 256)
%
% OUTPUT:
%   cmap - n x 3 RGB matrix (0–1 range)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FUNCTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function cmap = cmap_coolwarm(n)
    
    %% --------------------------------------------------------------------
    %% 1. Set default input
    %% --------------------------------------------------------------------
    if nargin < 1, n = 256; end

    %% --------------------------------------------------------------------
    %% 2. Define node colors (RGB, 0–1) from Matplotlib coolwarm
    %% --------------------------------------------------------------------
    % Hex: #3b4cc0, #5d7ce6, #82a6fb, #aac7fd, #cdd9ec,
    %      #ead4c8, #f7b89c, #f18d6f, #d95847, #b40426
    nodes = [
        0.22981  0.29872  0.75368;
        0.36346  0.48478  0.90102;
        0.51082  0.64940  0.98508;
        0.66725  0.77918  0.99296;
        0.80496  0.85167  0.92617;
        0.91938  0.83127  0.78287;
        0.96820  0.72084  0.61229;
        0.94405  0.55315  0.43555;
        0.85238  0.34649  0.28035;
        0.70567  0.01556  0.15023
    ];

    %% --------------------------------------------------------------------
    %% 3. Interpolate to n colors
    %% --------------------------------------------------------------------
    pos = linspace(0, 1, size(nodes,1));
    cmap = interp1(pos, nodes, linspace(0, 1, n), 'pchip');
end