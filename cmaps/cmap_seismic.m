%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FILE DESCRIPTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% FILENAME: cmap_seismic.m
%
% DESCRIPTION: Diverging blue-white-red colormap (seismic style).
%              Classic for wave amplitudes, stress, or velocity.
%              Interpolates between 10 sampled colors.
%
% INPUT:
%   n - Number of colors (default: 256)
%
% OUTPUT:
%   cmap - n x 3 RGB matrix (0–1 range)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% FUNCTION %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

function cmap = cmap_seismic(n)
    
    %% --------------------------------------------------------------------
    %% 1. Set default input
    %% --------------------------------------------------------------------
    if nargin < 1, n = 256; end

    %% --------------------------------------------------------------------
    %% 2. Define node colors (RGB, 0–1) from Matplotlib seismic
    %% --------------------------------------------------------------------
    % Hex: #00004c, #00009b, #0000e9, #5555ff, #c5c5ff,
    %      #ffc5c5, #ff5555, #f00000, #b80000, #800000
    nodes = [
        0.00000  0.00000  0.30000;
        0.00000  0.00000  0.60745;
        0.00000  0.00000  0.91490;
        0.33333  0.33333  1.00000;
        0.77255  0.77255  1.00000;
        1.00000  0.77255  0.77255;
        1.00000  0.33333  0.33333;
        0.93922  0.00000  0.00000;
        0.71961  0.00000  0.00000;
        0.50000  0.00000  0.00000
    ];

    %% --------------------------------------------------------------------
    %% 3. Interpolate to n colors
    %% --------------------------------------------------------------------
    pos = linspace(0, 1, size(nodes,1));
    cmap = interp1(pos, nodes, linspace(0, 1, n), 'pchip');
end